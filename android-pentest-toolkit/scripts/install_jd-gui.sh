#!/bin/bash

###############################################################################
# JD-GUI Installation Script
# Java Decompiler with GUI
###############################################################################

TOOL_NAME="jd-gui"
TOOL_DIR="/opt/android-pentest/tools/${TOOL_NAME}"
BIN_DIR="/opt/android-pentest/bin"
LOG_FILE="/opt/android-pentest/logs/${TOOL_NAME}_install.log"

source /opt/android-pentest/scripts/common_functions.sh

install_jdgui() {
    log_info "Installing ${TOOL_NAME}..."
    
    mkdir -p "${TOOL_DIR}"
    cd "${TOOL_DIR}"
    
    # Download JD-GUI
    JDGUI_VERSION="1.6.6"
    log_info "Downloading JD-GUI v${JDGUI_VERSION}..."
    
    wget "https://github.com/java-decompiler/jd-gui/releases/download/v${JDGUI_VERSION}/jd-gui-${JDGUI_VERSION}.jar" >> "$LOG_FILE" 2>&1
    
    # Create launcher script
    cat > "${TOOL_DIR}/jd-gui" << 'EOF'
#!/bin/bash
java -jar /opt/android-pentest/tools/jd-gui/jd-gui-*.jar "$@"
EOF
    
    chmod +x "${TOOL_DIR}/jd-gui"
    
    # Create wrapper script
    create_wrapper "jd-gui" "${TOOL_DIR}/jd-gui" ""
    
    log_success "${TOOL_NAME} installed successfully"
}

install_jdgui
