# Android Pentesting Toolkit - Quick Reference Guide

## üöÄ One-Line Installation

```bash
sudo bash master_install.sh
```

## üìç Essential Commands After Installation

```bash
# Add to PATH (add to ~/.bashrc for persistence)
export PATH="/opt/android-pentest/bin:$PATH"

# Verify installation
ls /opt/android-pentest/bin
```

## üîß Common Workflows

### 1. APK Analysis Workflow

```bash
# Step 1: Decompile APK with Apktool
apktool d app.apk -o app_decompiled

# Step 2: Decompile to Java with JADX
jadx app.apk -d app_jadx_output

# Step 3: Open in JADX GUI for analysis
jadx-gui app.apk

# Step 4: Convert DEX to JAR (alternative)
d2j-dex2jar app.apk
jd-gui app-dex2jar.jar
```

### 2. Dynamic Analysis Workflow

```bash
# Step 1: Connect device
adb devices

# Step 2: Install app
adb install app.apk

# Step 3: Start Frida server on device
adb push frida-server /data/local/tmp/
adb shell "chmod 755 /data/local/tmp/frida-server"
adb shell "/data/local/tmp/frida-server &"

# Step 4: List running apps
frida-ps -U

# Step 5: Hook into app with Objection
objection --gadget com.example.app explore
```

### 3. Network Traffic Analysis

```bash
# Option 1: Using mitmproxy
mitmproxy -p 8080

# Option 2: Using Burp Suite
burpsuite

# Configure proxy on device:
# Settings > Network > Manual Proxy
# Host: <your-ip>
# Port: 8080

# Install CA certificate on device for HTTPS
```

### 4. Automated Security Testing

```bash
# Start MobSF
mobsf
# Access: http://localhost:8000

# Upload APK through web interface
# View automated analysis results
```

### 5. Component Analysis with Drozer

```bash
# Step 1: Install Drozer agent on device
adb install /opt/android-pentest/tools/drozer/drozer-agent.apk

# Step 2: Forward port
adb forward tcp:31415 tcp:31415

# Step 3: Start Drozer agent on device

# Step 4: Connect with Drozer
drozer console connect

# Step 5: Enumerate attack surface
dz> run app.package.attacksurface com.example.app
dz> run app.package.info -a com.example.app
dz> run app.activity.info -a com.example.app
```

## üì± Device Setup

### Enable Developer Mode (Android)

1. Settings > About Phone
2. Tap "Build Number" 7 times
3. Settings > Developer Options
4. Enable "USB Debugging"
5. Enable "Stay Awake"

### Root Device (Optional, for deeper testing)

```bash
# Check if device is rooted
adb shell su

# If not rooted, use Magisk or similar
```

### Install Frida Server on Device

```bash
# Download Frida server
wget https://github.com/frida/frida/releases/download/16.1.4/frida-server-16.1.4-android-arm64.xz
unxz frida-server-16.1.4-android-arm64.xz

# Push to device
adb push frida-server-16.1.4-android-arm64 /data/local/tmp/frida-server
adb shell "chmod 755 /data/local/tmp/frida-server"

# Run Frida server
adb shell "/data/local/tmp/frida-server &"
```

## üîç Quick Tool Reference

| Task | Tool | Command |
|------|------|---------|
| Decompile APK | Apktool | `apktool d app.apk` |
| Recompile APK | Apktool | `apktool b app_dir -o new.apk` |
| Java decompile | JADX | `jadx app.apk -d output` |
| DEX to JAR | dex2jar | `d2j-dex2jar classes.dex` |
| View JAR | JD-GUI | `jd-gui file.jar` |
| Python analysis | Androguard | `androguard analyze app.apk` |
| Dynamic hook | Frida | `frida -U -f com.app` |
| Runtime explore | Objection | `objection explore` |
| HTTP proxy | mitmproxy | `mitmproxy` |
| Security scan | MobSF | `mobsf` |
| Component test | Drozer | `drozer console connect` |

## üéØ Common Pentesting Checks

### 1. AndroidManifest.xml Analysis

```bash
# Decompile to read manifest
apktool d app.apk

# Check for:
# - Exported components (activities, services, receivers)
# - Dangerous permissions
# - Debuggable flag
# - Backup allowed
# - cleartext traffic

cat app_decompiled/AndroidManifest.xml
```

### 2. Code Analysis

```bash
# Open in JADX
jadx-gui app.apk

# Look for:
# - Hardcoded secrets (API keys, passwords)
# - Insecure crypto
# - SQL injection points
# - Insecure file storage
# - Insecure network calls
```

### 3. Data Storage Check

```bash
# Pull app data
adb shell "run-as com.example.app cat databases/app.db" > app.db

# Check shared preferences
adb shell "run-as com.example.app cat shared_prefs/prefs.xml"
```

### 4. SSL Pinning Bypass

```bash
# Using Objection
objection --gadget com.example.app explore

# Inside Objection
android sslpinning disable
```

### 5. Root Detection Bypass

```bash
# Using Frida
frida -U -f com.example.app -l bypass_root.js
```

## üõ†Ô∏è Tool-Specific Tips

### Apktool
```bash
# Use framework for specific device
apktool if framework-res.apk

# Decode without resources
apktool d app.apk -r

# Decode without sources
apktool d app.apk -s
```

### JADX
```bash
# Decompile with all options
jadx --show-bad-code --deobf app.apk

# Export Gradle project
jadx --export-gradle app.apk
```

### Frida
```bash
# List processes
frida-ps -U

# Attach to process
frida -U -p <pid>

# Load script
frida -U -f com.app -l script.js

# Trace functions
frida-trace -U -f com.app -i "open*"
```

### Objection
```bash
# Basic explore
objection --gadget com.app explore

# Useful commands inside objection:
android hooking list classes
android hooking search classes <keyword>
android intent launch_activity <activity>
android sslpinning disable
memory dump all <file>
```

## üìù Cheat Sheet: Security Issues to Check

‚úÖ **Insecure Data Storage**
- Check SharedPreferences
- Check SQLite databases
- Check external storage
- Check logs

‚úÖ **Insecure Communication**
- Check for HTTP traffic
- Test SSL/TLS implementation
- Check for certificate validation
- Test SSL pinning

‚úÖ **Insecure Authentication**
- Test biometric bypass
- Check token storage
- Test session management
- Check password policies

‚úÖ **Insecure Authorization**
- Test privilege escalation
- Check access controls
- Test exported components
- Check intent filters

‚úÖ **Code Quality**
- Check for code obfuscation
- Look for hardcoded secrets
- Check for debugging code
- Test error handling

‚úÖ **Platform Misuse**
- Test WebView security
- Check intent redirection
- Test broadcast receivers
- Check services

## üîÑ Update Tools

```bash
# Update Python tools
cd /opt/android-pentest/tools/<tool>/venv
source bin/activate
pip install --upgrade <package>

# Update system tools
apt update && apt upgrade

# Update Android SDK
sdkmanager --update
```

## üìä Reporting

### Generate Reports with MobSF
1. Upload APK to MobSF (http://localhost:8000)
2. Run automated scan
3. Download PDF/JSON report

### Manual Reporting Template

1. **Executive Summary**
2. **Vulnerability Findings**
   - Critical
   - High
   - Medium
   - Low
3. **Technical Details**
4. **Proof of Concept**
5. **Recommendations**
6. **Appendix**

## üÜò Emergency Commands

```bash
# Kill ADB server
adb kill-server

# Restart ADB
adb start-server

# Reboot device
adb reboot

# Logcat monitoring
adb logcat | grep <package>

# Force stop app
adb shell am force-stop com.example.app

# Clear app data
adb shell pm clear com.example.app
```

---

**For detailed documentation, see README.md**
**For tool inventory, see TOOLS_INVENTORY.md**
